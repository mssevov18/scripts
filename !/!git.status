#!/usr/bin/env bash

# 📋 Get Git status output
STATUS=$(git status --short)

if [[ -z "$STATUS" ]]; then
	echo "✔️ Working tree clean."
	!notify "✔️ No Changes" "dialog-information" "Your Git working directory is clean."
	exit 0
fi

# 🖼️ Show status nicely
gum style --foreground 212 --border normal --margin "1 2" --padding "1 2" --border-foreground 57 "$(git status --short)"

# ➕ Prompt to add files
if gum confirm "Do you want to add files?" --default=false; then
	!git.add
	# ✅ Commit if confirmed
	if gum confirm "Do you want to commit staged changes?" --default=true; then
		!commit
	else
		!notify "🚫 Commit Cancelled" "dialog-warning" "Changes remain unstaged or uncommitted."
	fi
fi

# 🔄 Recheck status
# if git diff --cached --quiet; then
# 	if ! gum confirm "No staged changes. Do you want to commit anyway?" --default=false; then
# 		!notify "❎ Skipped Commit" "dialog-warning" "No files staged."
# 		exit 0
# 	fi
# fi
