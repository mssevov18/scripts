#!/usr/bin/env bash

# ğŸ“‹ Get Git status output
STATUS=$(git status --short)

if [[ -z "$STATUS" ]]; then
	echo "âœ”ï¸ Working tree clean."
	!notify "âœ”ï¸ No Changes" "dialog-information" "Your Git working directory is clean."
	exit 0
fi

# ğŸ–¼ï¸ Show status nicely
gum style --foreground 212 --border normal --margin "1 2" --padding "1 2" --border-foreground 57 "$(git status --short)"

# â• Prompt to add files
if gum confirm "Do you want to add files?" --default=false; then
	!git.add
	# âœ… Commit if confirmed
	if gum confirm "Do you want to commit staged changes?" --default=true; then
		!commit
	else
		!notify "ğŸš« Commit Cancelled" "dialog-warning" "Changes remain unstaged or uncommitted."
	fi
fi

# ğŸ”„ Recheck status
# if git diff --cached --quiet; then
# 	if ! gum confirm "No staged changes. Do you want to commit anyway?" --default=false; then
# 		!notify "â Skipped Commit" "dialog-warning" "No files staged."
# 		exit 0
# 	fi
# fi
